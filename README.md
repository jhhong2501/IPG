# IPG
## 5. Scenario Editor
CarMaker에서 Scenario Editor는 차량 및 운전 시뮬레이션을위한 매우 복잡한 도로 네트워크를 생성 할 수있는 그래픽 사용자 인터페이스 (GUI)입니다. 
매개 변수 메뉴를 클릭하고 시나리오 / 도로를 선택하여 CarMaker GUI를 통해 액세스 할 수 있습니다. 
Scenario Editor는 도로 건설 모듈의 프런트 엔드이고 백엔드 모듈 인 IPGRoad는 CarMaker에서 도로와 풍경을 만드는 데 사용되는 소프트웨어 라이브러리입니다. 
또한 Scenario Editor는 도로 네트워크를 설계하고 구축하는 것뿐만 아니라 테스트 차량과 교통 개체의 경로 정의를 용이하게하기위한 것입니다. 
또한 Stochastic Traffic Generator 덕분에 엄청난 양의 트래픽 개체를 쉽게 정의 할 수 있습니다.

### 5.1 Theory of IPGRoad
IPGRoad는 Scenario Editor에서 도로를 만드는 데 사용하는 소프트웨어 라이브러리입니다.
IPGRoad의 도로망은 생성시 특정 계층 구조를 따릅니다.
도로망은 교차로로 연결된 여러 차선이있는 도로로 구성됩니다.
전체 네트워크는 여러 개의 소위 링크로 나뉩니다. 이들은 양쪽 끝에 하나씩 두 개의 노드로 제한됩니다.
그런 다음 링크를 별도의 레인 섹션으로 더 세분화 할 수 있습니다.
레인 섹션은 특정 수의 레인이있는 링크에서 발췌 한 것입니다. 마지막으로 레인 섹션에는 여러 레인이 포함될 수 있습니다.
도로망의 논리적 구조를 이해하기 위해 단순화 된 예제 트리 구조를 사용하여 가장 중요한 구성 요소를 표시합니다.

#### Theory of IPGRoad
모든 도로는 측면 및 종단 높이와 캠버 프로파일을 갖도록 모델링 할 수 있습니다.
교차로 표면을 만드는 동안 교차로에서 만나는 서로 다른 개별 도로의 높이, 경사 및 곡률이 고려됩니다.
또한 범프 나 빔을 추가하는 것과 같이 도로의 국부 표면을 변경할 수있는 다양한 가능성을 사용할 수 있습니다.
이러한 모든 구성 요소는 다른 모든 구성 요소와 속성도 표시하는 확장 된 트리 구조를 포함하여 다음 장에서 적절하게 설명됩니다.
더 나은 시각화를 위해 그림 5.2는 도로망 자체를 그래프로 보여줍니다.
절점은 교차점을 나타내고 방향 모서리는 링크를 표시합니다.


#### Terms and Definitions
|제목|내용|
|------|---|
|Junction|다른 링크를 연결하는 데 사용되는 도로 요소|
|Link|도로망의 한 섹션, 일반적으로 하나의 도로|
|Reference Line|전역 (x, y, z) 좌표로 정의 된 도로 곡률|
|Lane|링크의 측면 확장 |
|Lane Section|일정한 수의 차선이있는 링크 섹션|
|Path|차량이 주행 할 수있는 사전 정의 또는 사용자 정의 궤적, 방향은 도로의 주행 측면 또는 사용자 정의에 따라 다릅니다 (세 가지 유형 : 차선 경로, 커넥터 경로 및 사용자 경로)|
|Route|도로에서 차량 이동의 원하는 전체 코스를 정의하는 궤적은 하나 이상의 경로로 구성됩니다.|
|Elevation Profile|측면, 종 방향 및 캠버 프로파일 변경|

#### Junction
교차로는 링크를 서로 결합하는 도로 요소입니다.
정션이 존재하려면 최소 2 개의 링크가 필요하며 IPGRoad는 정션 당 최대 8 개의 링크를 지정합니다.
기하학적 관점에서 볼 때 접합은 링크 간 전환의 최대 표면 부드러움을 목표로 할 때 특히 유리합니다.

접합에는 두 가지 유형이 있습니다. 팔 사이의 각도에 따라 구별 할 수 있습니다.
+ 유형 1 : 최대 8 개의 암을 가질 수있는 일반 접합.
+ 유형 2 : 팔 사이의 각도가 0도 또는 180 도인 고속도로 입구 및 출구. 이 접합 유형을 램프라고합니다.

일반 교차점을 모델링 할 때 베 지어 함수는 도로 표면을 설명하는 데 사용됩니다.
경사로의 경우 링크는 추가 표면 설명없이 서로 병합 될뿐입니다.

#### Link
링크는 일반적으로 하나의 도로 인 도로 네트워크 섹션에 대한 설명이며 하나 이상의 차선 세그먼트를 사용하여 추가로 지정할 수 있습니다.
각 링크에는 3D 미리보기 기술 도면 모드에서 도로망을 볼 때 중요한 역할을하는 링크 ID가 표시됩니다.
이 항목에 대한 자세한 내용은 'IPGMovie의 특수 미리보기 모드'섹션을 참조하세요.


#### Reference Line
링크의 과정은 참 조선에 의해 정의됩니다.
기준선은 전역 (x, y, z) 좌표로 표시되며 (x, y) 수준에 있습니다.
도로의 변화를 모델링 할 때 설정되는 지점 사이에 형성되는 여러 세그먼트로 세분화 될 수 있습니다.
Link 자체는 Node0 (시작점)과 Node1 (종료점)에 의해 제한됩니다.
전체 시뮬레이션에서 가장 중요한 것은 링크를 따라 기준선을 따라 이동하는 s 축과 t 축입니다.

(s, t) 좌표계의 원점은 Node0에 있고, s 축은 기준선을 따라 이동하고 t 축은 s 축 왼쪽에서 직각으로 이동합니다.
s- 축은 도로 장애물을 추가 할 때 중요합니다.
장애물 위치는 s- 축을 따라 링크 또는 교차로 입구 또는 출구의 시작 또는 끝에서 거리에 따라 지정됩니다.
이러한 방식으로 도로 장애물을 구현할 때의 장점은 장애물을 추가하기 전에 링크를 변경하면 그에 따라 위치가 조정된다는 것입니다.


#### Lane
차선은 s, t 레벨에서 링크의 측면 확장입니다.
레인 섹션을 형성하기 위해 최대 10 개의 레인을 정의 할 수 있으며 각 레인의 너비는 개별적으로 사용자가 조정할 수 있습니다.
즉, 차선 너비에 대한 지원 지점은 서로 독립적이며 차선 섹션을 기준으로 정의됩니다.
너비, 너비 차이 및 너비 보간에 대해 값을 매개 변수화 할 수 있습니다.
보간을 수행하는 데 사용할 수있는 세 가지 방법은 3 차, 선형 및 단계입니다.
차선 너비를 0으로 설정하는 것은 병합 또는 분기되는 차선을 모델링하는 간단하고 유효한 방법을 나타내므로 명시 적으로 바람직합니다.
또한 레인에 특정 유형을 할당 할 수 있습니다.
이러한 유형 중 일부는 도로, 하숙인, 길가 및 교통 섬입니다.
따라서 각 차선은 테스트 차량에 접근 할 수 없습니다.

#### Lane Section
레인 섹션은 일정한 수의 레인이있는 링크의 섹터입니다.
링크는 임의의 수의 레인 섹션으로 구성 될 수 있으며 각 레인 섹션의 시작점은 추가 링크의 Node0과 관련하여 정의됩니다.
새로운 레인 섹션의 시작은 이전 섹션을 종료합니다.
차선 수가 변경되는 경우에만 새 차선 섹션을 정의해야합니다.
차선 폭만 변경되는 경우 링크 방향의 기능으로 폭을 정의하는 것으로 충분합니다.

#### Path
경로는 경로를 정의하는 데 사용되는 링크의 궤적 섹션입니다.
경로 정의를 위해 선택할 수있는 세 가지 유형의 경로가 있습니다.

+ 차선 경로 : 차선 경로는 차선의 경로를 따르며 모든 차선 섹션 내의 모든 차선에 대해 별도의 사전 설정이 있습니다.
이를 통해 사용자는 차량이 주행 할 차선을 쉽게 결정할 수 있습니다.
차선 경로는 차선의 중앙을 따라 직접 실행됩니다. 즉, 차선의 왼쪽 및 오른쪽 폭에 따라 경로가 변경 될 수 있습니다.

+ 커넥터 경로 : 커넥터 경로는 시작점과 끝점으로 구성되며 스플라인을 사용하여 다른 기존 경로를 서로 연결하는 데 사용됩니다.
접합에서 커넥터 경로를 정의 할 수도 있습니다.
이 유형의 경로는 주로 차선 변경과 관련이 있습니다.

+ 사용자 경로 : 사용자 경로는 사용자에게 최대의 유연성을 제공하는 반면 지원 노드 포인트는 한 방향으로가는 개별 경로를 정의하기 위해 무작위로 배치 될 수 있습니다.
노드 점은 스플라인으로 연결됩니다.

#### Route
경로는 자체 (s, t) 좌표계를 가진 연속 경로의 시퀀스입니다.
경로는 모든 유형이 될 수 있으며 임의의 순서로 연결될 수 있습니다.
경로는 차량의 가능한 로드맵뿐만 아니라 운전자와 차량이 정확히 어디에 위치 할 것인지도 보여줍니다.
이것은 코너 절단과 특정 차선에서의 운전을 고려합니다.
도로에서 다양한 운전 가능성을 설명하기 위해 다양한 경로를 정의 할 수 있습니다.

#### Elevation Profile
도로 표면의 높이는 링크의 s- 방향을 따라 정의 할 수 있으며 도로의 세로 및 가로 Z- 프로파일을 매개 변수화하여 특성화됩니다.
이는 고도, 경사 및 캠버에 대한 값을 설정하여 수행됩니다.
Elevation은 Node0에 대한 상대적인 거리의 높이와 기울기 값을 정의하여 도로의 종단 고도 프로파일을 조정하는 데 사용됩니다.
경사 및 캠버는 절대 경사 및 경사 차이뿐만 아니라 절대 류트 곡률 및 곡률 차이를 지정하여 도로의 후도 높이 프로파일을 정의합니다.
이러한 값은 Node0에 대한 상대적 거리로도 명시됩니다.
추가하는 z- 프로파일의 지원 지점의 양과 s- 좌표는 서로 독립적입니다.
z(s,t) = elev(s) + slope(s,t) + camber (s,t)


### 5.3 Building Roads with Scenario Editor
시나리오 편집기는 다음 작업에서 사용자를 지원하는 그래픽 사용자 인터페이스입니다.
+ 도로 네트워크 구축
+ 다른 종류의 도로 범프를 추가하여 도로 표면 수정
+ 교통 표지판 및 신호등 추가
+ 자아 차량 또는 기타 교통 개체에 각각 할당 할 수있는 다른 경로 정의
+ 기타 기타 물체를 추가하여 주변 환경을 아름답게하고 지상비를 생성합니다.





## simulink

### line sensor

이 블록의 목적은 차량 데이터 세트에 정의 된 라인 센서에서 정보를 요청하는 것입니다. 센서는 블록 입력 포트의 신호 또는 블록 매개 변수의 고정 값에 의해 동적으로 선택 될 수 있습니다. 인덱스 카운터는 0으로 시작합니다.
이 블록은 장착 된 프레임에서 센서의 외부 회전 및 이동과 최신 업데이트의 타임 스탬프와 같은 선택된 라인 센서에 대한 일반 데이터를 출력합니다. 또한 현재 감지 된 라인 수를 제공합니다.



